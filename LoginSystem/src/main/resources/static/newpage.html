<!doctype html>
<html>

<head>
	<title>정보처리기사_로그인시스템구현하기</title>
	<meta charset="utf-8" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	<script src ="common.js"></script>
</head>


<body> 
	<h1>공통모듈 작동 페이지</h1>
	<div id="uicontainer">
		<label>아 이 디<input type="text" id="myid" /></label>
		<label>비밀번호<input type="password" id="mypw" /></label>
		<button id ="signin">로그인</button>
	</div>
	<a href="#" id="logoutContainer"></a>
</body>
<script>
	$("#signin").click(async() => { // 로그인 버튼 클릭할 때 실행되는 이벤트 리스너, async로 비동기 작업 처리 가능.
		const data = await login($("#myid").val(), $("#mypw").val()); // login 함수에 사용자가 입력한 아이디와 비밀번호 값을 넘겨주고, 
		// await을 사용하여 기다렸다가 결과 data 변수를 저장함.
		if(data.message == "로그인 성공") { 
			$("#uicontainer").text(`${data.member.mid}(${data.member.name})) 
			님 로그인 하신걸 환영합니다.`) // ${data.member.mid}(${data.member.name}) -> data객체의 정보를 표시하는 템플릿 리터럴
			logout($("#logoutContainer")) // logout 처리하도록 #logoutContainer를 전달하여 작업 처리함.
		} else {
			alert("아이디와 비밀번호를 다시 확인해주세요.") // 로그인 실패했을 때 경고 메세지.
		}
	})
</script>

</html>